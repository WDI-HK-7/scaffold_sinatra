#!/usr/bin/env ruby

require 'fileutils'
require 'open-uri'
require 'colorize'
require 'pry'

include FileUtils

cmd = ARGV[0]
project_name = ARGV[1]

if cmd == 's' || cmd == 'server'
  system('bundle exec shotgun -p 3000')
  exit
else
  if Dir.exist?(project_name)
    puts "#{project_name} already exists!".red
    exit
  end
end

# make app repo
mkdir(project_name)

# and do all the work there...
cd(project_name) do

  # assets
  makedirs(['public', 'public/images', 'public/stylesheets', 'views', 'spec'])

  # styles
  File.open('public/stylesheets/normalize.css', 'w+') do |f|
    # normalize_url = 'https://raw.githubusercontent.com/necolas/normalize.css/master/normalize.css'
    # f.write(open(normalize_url).read)
  end

  # views
  File.open('views/layout.erb', 'w+') do |f|
    #
  end

  # Index.erb
  File.open('views/index.erb', 'w+') do |f|
    #
  end

  # Gemfile
  File.open('Gemfile', 'w+') do |f|
    #
  end

  # # default app!
  File.open('app.rb', 'w+') do |f|
    #
  end

  # config.ru
  File.open('config.ru', 'w+') do |f|
    #
  end

  system('bundle install')

  puts('>> OK!'.white)
  puts(">> Created #{project_name}!".green)
  puts('>> use `bundle exec shotgun -p 3000` from inside the folder to run it!')
end
